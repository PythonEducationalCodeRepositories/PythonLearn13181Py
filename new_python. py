import os
from PIL import Image
from docx import Document
from datetime import datetime

# Function to get image details
def get_image_details(image_path):
    try:
        image = Image.open(image_path)
        image_details = {
            'filename': os.path.basename(image_path),
            'size': image.size,
            'format': image.format,
            'mode': image.mode,
            'creation_time': datetime.fromtimestamp(os.path.getctime(image_path)).strftime('%Y-%m-%d %H:%M:%S')
        }
        return image_details
    except Exception as e:
        print(f"Error processing image {image_path}: {e}")
        return None

# Function to write details to Word file
def write_to_word(image_details, output_path):
    doc = Document()
    doc.add_heading('Screenshot Details', 0)

    for detail in image_details:
        doc.add_paragraph(f"Filename: {detail['filename']}")
        doc.add_paragraph(f"Size: {detail['size']}")
        doc.add_paragraph(f"Format: {detail['format']}")
        doc.add_paragraph(f"Mode: {detail['mode']}")
        doc.add_paragraph(f"Creation Time: {detail['creation_time']}")
        doc.add_paragraph("-" * 40)
    
    doc.save(output_path)

# Main function to handle the workflow
def main():
    # Get the current working directory
    cwd = os.getcwd()

    # Path to the folder containing screenshots (assuming it's in cwd)
    folder_name = "screenshots"  # replace with the actual folder name if needed
    folder_path = os.path.join(cwd, folder_name)

    # Get all PNG files from the folder
    png_files = [f for f in os.listdir(folder_path) if f.lower().endswith('.png')]
    png_file_paths = [os.path.join(folder_path, f) for f in png_files]

    # Sort files by creation time (ascending order)
    png_file_paths.sort(key=lambda x: os.path.getctime(x))

    # Get the details of each image
    image_details = []
    for file_path in png_file_paths:
        details = get_image_details(file_path)
        if details:
            image_details.append(details)

    # Write the image details to a Word file
    output_word_path = os.path.join(cwd, 'screenshot_details.docx')
    write_to_word(image_details, output_word_path)

    print(f"Details written to {output_word_path}")

if __name__ == '__main__':
    main()