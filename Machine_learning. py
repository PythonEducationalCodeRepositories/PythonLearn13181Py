import chromadb

# Connect to ChromaDB (Persistent Storage)
chroma_client = chromadb.PersistentClient(path="./chroma_db")

# Get all collections
collections = chroma_client.list_collections()

# If no collections exist
if not collections:
    print("❌ No collections found in ChromaDB.")
    exit()

print("📂 **Available Collections:**")
for collection in collections:
    print(f"- {collection.name}")

print("\n📜 **Full Schema Dump**")
print("=" * 50)

# Iterate over all collections
for collection in collections:
    print(f"\n🔍 **Collection: {collection.name}**")
    print("-" * 50)

    # Load the collection
    col = chroma_client.get_collection(name=collection.name)

    # Fetch all data (Documents, Metadata, Embeddings)
    data = col.get(include=["documents", "metadatas", "embeddings"])

    # Print total records
    print(f"📊 Total Records: {len(data['documents'])}")

    # Print schema from first record (as example)
    if len(data["documents"]) > 0:
        print("\n📝 **Schema Example:**")
        print(f"🔹 **Document Sample:** {data['documents'][0]}")
        print(f"🔹 **Metadata Sample:** {data['metadatas'][0]}")
        print(f"🔹 **Embedding Sample (First 5 values):** {data['embeddings'][0][:5]} ...")

    print("=" * 50)